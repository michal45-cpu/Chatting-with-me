<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Simple Chat</title>

<style>
body {
  font-family: Arial;
  background: #ece5dd;
  margin: 0;
}
#chat {
  max-width: 600px;
  margin: auto;
  height: 100vh;
  display: flex;
  flex-direction: column;
}
#messages {
  flex: 1;
  overflow-y: auto;
  padding: 10px;
}
.msg {
  margin: 5px;
  padding: 8px 12px;
  border-radius: 10px;
  max-width: 70%;
}
.me {
  background: #dcf8c6;
  margin-left: auto;
}
.other {
  background: white;
}
#input {
  display: flex;
  padding: 10px;
  background: #f0f0f0;
}
input {
  flex: 1;
  padding: 8px;
}
button {
  padding: 8px 12px;
}
</style>
</head>

<body>

<div id="chat">
  <div id="messages"></div>

  <div id="input">
    <input id="text" placeholder="Type message..." />
    <button onclick="send()">Send</button>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyD-kvDCmugkiKK5p-pgWYXGhpuCySrFW7w",
  authDomain: "fevorite-things.firebaseapp.com",
  projectId: "fevorite-things",
  storageBucket: "fevorite-things.firebasestorage.app",
  messagingSenderId: "107020931792",
  appId: "1:107020931792:web:9560925a6b2f733aea44d5",
  measurementId: "G-8R2W1MS503"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// AUTO LOGIN (TEMP)
auth.signInWithEmailAndPassword("utkarshdixit400@gmail.com", "kaushiki");

// LISTEN MESSAGES
db.collection("chat").orderBy("time")
.onSnapshot(snap => {
  messages.innerHTML = "";
  snap.forEach(doc => {
    const m = doc.data();
    const div = document.createElement("div");
    div.className = "msg " + (m.uid === auth.currentUser.uid ? "me" : "other");
    div.textContent = m.text;
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
  });
});

// SEND MESSAGE
function send() {
  const t = text.value;
  if (!t) return;

  db.collection("chat").add({
    text: t,
    uid: auth.currentUser.uid,
    time: firebase.firestore.FieldValue.serverTimestamp()
  });

  text.value = "";
}
</script>

</body>
</html>